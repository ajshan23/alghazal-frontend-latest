import{r as d,j as e,v as w,ak as D}from"./index-BxO48E7J.js";import{t as f,N as y}from"./toast-CyYsqkVZ.js";import{a as N,e as F,b as S}from"./api-DPNZB6Au.js";import{F as k,a as E,b as x}from"./formik.esm-COq3CY63.js";import{c as B,b as j}from"./index.esm-B_aVpQ9s.js";import"./Alert-DAYHHcTG.js";import"./index-D65Or3wn.js";import"./Badge-BDINMpeU.js";import{B as h}from"./Button-Cqs6OGDK.js";import"./Calendar-CZCjMlL9.js";import"./Card-BkELxnQG.js";import"./Skeleton-UhY8bWTz.js";import"./index-CbDZljJP.js";import"./Dialog-Y-f76L7n.js";import"./Drawer-C4WNb_Rb.js";import"./index-DPk-9BZv.js";import{F as I,a as C}from"./FormItem-BHnkbcAj.js";import"./useUniqueId-B5ZH9nmF.js";import{I as b}from"./Input-Bk_hBu-L.js";import"./index-CujXW8qQ.js";import"./index-DUubB36n.js";import"./Progress-B54yMz__.js";import"./index-ko3aNh7X.js";import"./ScrollBar-Dolz5Bqf.js";import"./index-BQv2iMDd.js";import"./Select-BKHxHb6S.js";import"./Upload-5TuzLRJ1.js";import"./index-Br-igED4.js";import"./Tag-oUmSLAu4.js";import"./index-DPAMRK6r.js";import{S as O}from"./StickyFooter-BwF7du_M.js";import{A}from"./index-DYW3Y-VP.js";import{a0 as R}from"./index-BvMts2N3.js";import{C as z}from"./ConfirmDialog-wZKJ97Q_.js";import{A as $}from"./AdaptableCard-DFT79cx9.js";import"./Views-DNvf1mRE.js";import"./chart.config-Dntevg-Q.js";import"./DataTable-BY0GTXYv.js";import"./SvgIcon-RMdG7_sD.js";import"./SegmentItemOption-BFgyQbW2.js";import"./StatusIcon-DL8X5trP.js";import"./CloseButton-C69hR3t8.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-Cgq6JklI.js";import"./cloneDeep-DJN0yfLA.js";import"./hoist-non-react-statics.cjs-Az_z3Foo.js";import"./floating-ui.react-BI-9OMXT.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-C5P6Zpzc.js";import"./context-BpXqFl7R.js";import"./useControllableState-Z-hTdTNR.js";import"./_getPrototype-CXL19Th3.js";import"./index-mlsqo1Ee.js";import"./index-Chjiymov.js";import"./toString-DS3ZSNMT.js";import"./index-Ci8JUJEH.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-VwH9CKQD.js";import"./index-BOBJKlrD.js";import"./useThemeClass-CVckhmrY.js";const v=d.forwardRef((i,r)=>{const{type:s,initialData:m={name:"",description:""},onFormSubmit:n,onDiscard:c,onDelete:u}=i,g=B().shape({name:j().required("Category name is required"),description:j()});return e.jsx(k,{innerRef:r,initialValues:{name:m.name||"",description:m.description||""},validationSchema:g,onSubmit:async(o,{setSubmitting:t,setErrors:p})=>{var l;try{await n(o,t)}catch(a){t(!1),(l=a.message)!=null&&l.includes("Category already exists")&&p({name:"This category name is already registered"})}},enableReinitialize:!0,validateOnChange:!0,validateOnBlur:!0,children:({errors:o,touched:t,isSubmitting:p})=>e.jsx(E,{children:e.jsxs(I,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs($,{divider:!0,className:"mb-4",children:[e.jsx("h5",{className:"mb-4",children:"Category Information"}),e.jsx(C,{label:"Category Name",invalid:!!(o.name&&t.name),errorMessage:o.name,children:e.jsx(x,{type:"text",autoComplete:"off",name:"name",placeholder:"Enter category name",component:b})}),e.jsx(C,{label:"Description",invalid:!!(o.description&&t.description),errorMessage:o.description,children:e.jsx(x,{as:"textarea",autoComplete:"off",name:"description",placeholder:"Enter any description",component:b,textArea:!0})})]})}),e.jsxs(O,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:s==="edit"&&u&&e.jsx(q,{onDelete:u})}),e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(h,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>c==null?void 0:c(),children:"Discard"}),e.jsx(h,{size:"sm",variant:"solid",loading:p,icon:e.jsx(A,{}),type:"submit",children:"Save"})]})]})]})})})});v.displayName="CategoryDetailsForm";const q=({onDelete:i})=>{const[r,s]=d.useState(!1),m=()=>{s(!1),i==null||i(s)},n=()=>{s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"text-red-600",variant:"plain",size:"sm",icon:e.jsx(R,{}),type:"button",onClick:()=>s(!0),children:"Delete"}),e.jsxs(z,{isOpen:r,type:"danger",title:"Delete Category",confirmButtonColor:"red-600",onClose:n,onRequestClose:n,onCancel:n,onConfirm:m,children:[e.jsx("p",{children:"Are you sure you want to delete this category?"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"This action cannot be undone."})]})]})},T={name:"",description:""},Ke=()=>{const i=w(),{id:r}=D(),[s,m]=d.useState(T),[n,c]=d.useState(!!r);d.useEffect(()=>{r&&(async()=>{try{const t=await N(r);if(!t||!t.data)throw new Error("Invalid category data");m({name:t.data.name||"",description:t.data.description||""}),c(!1)}catch(t){console.error("Error fetching category:",t),c(!1),f.push(e.jsx(y,{title:"Failed to fetch category data",type:"danger",duration:2500,children:t.message||"Something went wrong"}),{placement:"top-center"}),i("/app/categories")}})()},[r,i]);const u=async(o,t)=>{var p,l;t(!0);try{let a;r?a=await F(r,o):a=await S(o),a.status,t(!1),f.push(e.jsxs(y,{title:`Successfully ${r?"updated":"added"} category`,type:"success",duration:2500,children:["Category ",r?"updated":"added"," successfully"]}),{placement:"top-center"}),i("/app/cat-view")}catch(a){console.error("Error during form submission:",a),t(!1),f.push(e.jsx(y,{title:`Error ${r?"updating":"adding"} category`,type:"danger",duration:2500,children:((l=(p=a==null?void 0:a.response)==null?void 0:p.data)==null?void 0:l.message)||a.message}),{placement:"top-center"})}},g=()=>{i("/app/categories")};return n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsx(v,{type:r?"edit":"new",initialData:s,onFormSubmit:u,onDiscard:g})};export{Ke as default};
