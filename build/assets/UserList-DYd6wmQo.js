import{a9 as $,aa as K,ab as V,ac as G,a as T,j as e,r as j,v as Q,Q as N,m as W,ae as X}from"./index-D5qsHBPI.js";import{a as J,b as Y,u as Z}from"./SalesService-D6MDyEUo.js";import{A as ee}from"./AdaptableCard-UKh7K-Hq.js";import{A as te}from"./index-BVZVTO7z.js";import{B as ae}from"./Badge-Dxo-y_KI.js";import{D as se}from"./DataTable-B_anoiyl.js";import{I as oe,T as re,U as M,V as ne,W as ie,X as le}from"./index-Bjc1-Dfl.js";import{a as ce}from"./index-ToEsQX21.js";import{u as de}from"./useThemeClass-dAtDPqCv.js";import{t as R,N as k}from"./toast-BV-KR3on.js";import{C as me}from"./ConfirmDialog-DxnrbsV4.js";import{d as _}from"./debounce-BcvDMC3O.js";import{I as U}from"./Input-DpzrnPB-.js";import{b as ue,c as pe}from"./api-D2NL6qfU.js";import{B as C}from"./Button-DKlp8XN1.js";import{c as he,C as g}from"./Skeleton-Dmiutfuv.js";import{F as fe,a as D}from"./FormItem-BjAM8sYA.js";import{R as F}from"./index-CrE-Oq-m.js";import{D as xe}from"./Drawer-BUEyqvQR.js";import{F as ge,a as je,b as P}from"./formik.esm-XpKb_I1k.js";import"./Card-yHUwp5an.js";import"./floating-ui.react-CtRk2jQd.js";import"./floating-ui.dom-D1IisfOw.js";import"./index-CKN0MgBz.js";import"./proxy-QQ9UH2Rr.js";import"./index-WwDzlDyh.js";import"./index-C6AW9Bce.js";import"./Select-DCy0le_o.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-CTX8E6kM.js";import"./Views-B1b09e4F.js";import"./get-BV5slyYd.js";import"./toString-kQNaAZON.js";import"./index-B0JjbIhn.js";import"./StatusIcon-B-JCnJup.js";import"./CloseButton-CYqIcWKK.js";import"./chainedFunction-BxZSneMW.js";import"./Dialog-Dhhpr09S.js";import"./index-BKrnPZdN.js";import"./index-Chjiymov.js";import"./isNil-BKogIPw7.js";import"./_getPrototype-07QB_bHq.js";import"./cloneDeep-DJN0yfLA.js";const B="salesProductList",S=$(B+"/getProducts",async t=>(await J(t)).data),be=async t=>(await Y(t)).data,z={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ve={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:z,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},H=K({name:`${B}/state`,initialState:ve,reducers:{updateProductList:(t,o)=>{t.productList=o.payload},setTableData:(t,o)=>{t.tableData=o.payload},setFilterData:(t,o)=>{t.filterData=o.payload},toggleDeleteConfirmation:(t,o)=>{t.deleteConfirmation=o.payload},setSelectedProduct:(t,o)=>{t.selectedProduct=o.payload}},extraReducers:t=>{t.addCase(S.fulfilled,(o,u)=>{o.productList=u.payload.data,o.tableData.total=u.payload.total,o.loading=!1}).addCase(S.pending,o=>{o.loading=!0})}}),{updateProductList:Ft,setTableData:ye,setFilterData:Ce,toggleDeleteConfirmation:O,setSelectedProduct:Pt}=H.actions,Se=H.reducer,we=V({data:Se}),y=G,Ne=()=>{const t=T(),o=y(r=>r.salesProductList.data.deleteConfirmation),u=y(r=>r.salesProductList.data.selectedProduct),c=y(r=>r.salesProductList.data.tableData),p=()=>{t(O(!1))},n=async()=>{t(O(!1)),await be({id:u})&&(t(S(c)),R.push(e.jsx(k,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Product successfuly deleted"}),{placement:"top-center"}))};return e.jsx(me,{isOpen:o,type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:p,onRequestClose:p,onCancel:p,onConfirm:n,children:e.jsx("p",{children:"Are you sure you want to delete this product? All record related to this product will be deleted as well. This action cannot be undone."})})},De={true:{label:"Active",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},false:{label:"Inactive",dotClass:"bg-red-500",textClass:"text-red-500"}},Fe=({row:t})=>{const{textTheme:o}=de(),u=Q(),c=()=>{u(`/app/user-form/${t._id}`)},p=()=>{u(`/app/user-view/${t==null?void 0:t._id}`)};return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${o}`,onClick:p,children:e.jsx(oe,{})}),e.jsx("span",{className:`cursor-pointer p-2 hover:${o}`,onClick:c,children:e.jsx(re,{})})]})},Pe=({row:t})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{src:t.profileImage,icon:e.jsx(ce,{}),alt:`${t.firstName} ${t.lastName}`}),e.jsxs("span",{className:"ml-2 rtl:mr-2 font-semibold",children:[t.firstName," ",t.lastName]})]}),Ee=()=>{var b,v;const t=j.useRef(null),[o,u]=j.useState(""),[c,p]=j.useState({page:1,limit:10}),{data:n,isLoading:r,error:i,refetch:d}=Z({queryKey:["users",c.page,c.limit,o],queryFn:()=>ue({page:c.page,limit:c.limit,search:o})}),a=((b=n==null?void 0:n.data)==null?void 0:b.users)||[],s=((v=n==null?void 0:n.data)==null?void 0:v.pagination)||{total:0,page:1,limit:10,totalPages:1,hasNextPage:!1,hasPreviousPage:!1},x=j.useMemo(()=>_(m=>{u(m),p(f=>({...f,page:1}))},500),[]),l=m=>{x(m.target.value)},h=j.useMemo(()=>[{header:"Name",accessorKey:"name",cell:m=>e.jsx(Pe,{row:m.row.original})},{header:"Email",accessorKey:"email",cell:m=>e.jsx("span",{children:m.row.original.email})},{header:"Phone Number",accessorKey:"phoneNumbers",cell:m=>{var f;return e.jsx("span",{children:((f=m.row.original.phoneNumbers)==null?void 0:f[0])||"N/A"})}},{header:"Role",accessorKey:"role",cell:m=>e.jsx("span",{className:"capitalize",children:m.row.original.role})},{header:"Status",accessorKey:"isActive",cell:m=>{const f=m.row.original.isActive,L=De[f.toString()];return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:L.dotClass}),e.jsx("span",{className:`capitalize font-semibold ${L.textClass}`,children:L.label})]})}},{header:"Action",id:"action",cell:m=>e.jsx(Fe,{row:m.row.original})}],[]),A=m=>{p(f=>({...f,page:m}))},w=m=>{p(f=>({page:1,limit:m}))};return i?e.jsxs("div",{children:["Error loading users: ",i.message]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(U,{placeholder:"Search users...",onChange:l,className:"max-w-md"})}),e.jsx(se,{ref:t,columns:h,data:a,skeletonAvatarColumns:[0,3,4],skeletonAvatarProps:{className:"rounded-md"},loading:r,pagingData:{total:s.total,pageIndex:s.page,pageSize:s.limit},onPaginationChange:A,onSelectChange:w}),e.jsx(Ne,{})]})},Ae=()=>{const t=T(),o=j.useRef(null),u=y(i=>i.salesProductList.data.tableData),c=_(p,500);function p(i){const d=he(u);d.query=i,d.pageIndex=1,typeof i=="string"&&i.length>1&&n(d),typeof i=="string"&&i.length===0&&n(d)}const n=i=>{t(ye(i)),t(S(i))},r=i=>{c(i.target.value)};return e.jsx(U,{ref:o,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Search product",prefix:e.jsx(M,{className:"text-lg"}),onChange:r})},q=j.forwardRef(({onSubmitComplete:t},o)=>{const u=T(),c=y(n=>n.salesProductList.data.filterData),p=n=>{t==null||t(),u(Ce(n)),u(S(z))};return e.jsx(ge,{enableReinitialize:!0,innerRef:o,initialValues:c,onSubmit:n=>{p(n)},children:({values:n,touched:r,errors:i})=>e.jsx(je,{children:e.jsxs(fe,{children:[e.jsxs(D,{invalid:i.name&&r.name,errorMessage:i.name,children:[e.jsx("h6",{className:"mb-4",children:"Included text"}),e.jsx(P,{type:"text",autoComplete:"off",name:"name",placeholder:"Keyword",component:U,prefix:e.jsx(M,{className:"text-lg"})})]}),e.jsxs(D,{invalid:i.category&&r.category,errorMessage:i.category,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(P,{name:"category",children:({field:d,form:a})=>e.jsx(e.Fragment,{children:e.jsxs(g.Group,{vertical:!0,value:n.category,onChange:s=>a.setFieldValue(d.name,s),children:[e.jsxs(g,{className:"mb-3",name:d.name,value:"bags",children:["Bags"," "]}),e.jsxs(g,{className:"mb-3",name:d.name,value:"cloths",children:["Cloths"," "]}),e.jsxs(g,{className:"mb-3",name:d.name,value:"devices",children:["Devices"," "]}),e.jsxs(g,{className:"mb-3",name:d.name,value:"shoes",children:["Shoes"," "]}),e.jsxs(g,{name:d.name,value:"watches",children:["Watches"," "]})]})})})]}),e.jsxs(D,{invalid:i.status&&r.status,errorMessage:i.status,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(P,{name:"status",children:({field:d,form:a})=>e.jsx(e.Fragment,{children:e.jsxs(g.Group,{vertical:!0,value:n.status,onChange:s=>a.setFieldValue(d.name,s),children:[e.jsxs(g,{className:"mb-3",name:d.name,value:0,children:["In Stock"," "]}),e.jsxs(g,{className:"mb-3",name:d.name,value:1,children:["Limited"," "]}),e.jsxs(g,{className:"mb-3",name:d.name,value:2,children:["Out Of Stock"," "]})]})})})]}),e.jsxs(D,{invalid:i.productStatus&&r.productStatus,errorMessage:i.productStatus,children:[e.jsx("h6",{className:"mb-4",children:"Product Status"}),e.jsx(P,{name:"productStatus",children:({field:d,form:a})=>e.jsxs(F.Group,{vertical:!0,value:n.productStatus,onChange:s=>a.setFieldValue(d.name,s),children:[e.jsx(F,{value:0,children:"Published"}),e.jsx(F,{value:1,children:"Disabled"}),e.jsx(F,{value:2,children:"Archive"})]})})]})]})})})}),Le=({onSaveClick:t,onCancel:o})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(C,{size:"sm",className:"mr-2",onClick:o,children:"Cancel"}),e.jsx(C,{size:"sm",variant:"solid",onClick:t,children:"Query"})]}),Re=()=>{const t=j.useRef(null),[o,u]=j.useState(!1),c=()=>{u(!0)},p=()=>{u(!1)},n=()=>{var r;(r=t.current)==null||r.submitForm()};return e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(ne,{}),onClick:()=>c(),children:"Filter"}),e.jsx(xe,{title:"Filter",isOpen:o,footer:e.jsx(Le,{onCancel:p,onSaveClick:n}),onClose:p,onRequestClose:p,children:e.jsx(q,{ref:t,onSubmitComplete:p})})]})};q.displayName="FilterForm";var E={exports:{}},ke=E.exports,I;function Te(){return I||(I=1,function(t,o){(function(u,c){c()})(ke,function(){function u(a,s){return typeof s>"u"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,s,x){var l=new XMLHttpRequest;l.open("GET",a),l.responseType="blob",l.onload=function(){d(l.response,s,x)},l.onerror=function(){console.error("could not download file")},l.send()}function p(a){var s=new XMLHttpRequest;s.open("HEAD",a,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function n(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(s)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof N=="object"&&N.global===N?N:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(a,s,x){var l=r.URL||r.webkitURL,h=document.createElement("a");s=s||a.name||"download",h.download=s,h.rel="noopener",typeof a=="string"?(h.href=a,h.origin===location.origin?n(h):p(h.href)?c(a,s,x):n(h,h.target="_blank")):(h.href=l.createObjectURL(a),setTimeout(function(){l.revokeObjectURL(h.href)},4e4),setTimeout(function(){n(h)},0))}:"msSaveOrOpenBlob"in navigator?function(a,s,x){if(s=s||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(u(a,x),s);else if(p(a))c(a,s,x);else{var l=document.createElement("a");l.href=a,l.target="_blank",setTimeout(function(){n(l)})}}:function(a,s,x,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof a=="string")return c(a,s,x);var h=a.type==="application/octet-stream",A=/constructor/i.test(r.HTMLElement)||r.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||h&&A||i)&&typeof FileReader<"u"){var b=new FileReader;b.onloadend=function(){var f=b.result;f=w?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=f:location=f,l=null},b.readAsDataURL(a)}else{var v=r.URL||r.webkitURL,m=v.createObjectURL(a);l?l.location=m:location.href=m,l=null,setTimeout(function(){v.revokeObjectURL(m)},4e4)}});r.saveAs=d.saveAs=d,t.exports=d})}(E)),E.exports}var Ue=Te();const Oe=()=>{const[t,o]=j.useState(!1),u=async()=>{o(!0);try{const c=await pe();Ue.saveAs(c,`users_export_${new Date().toISOString().slice(0,10)}.csv`),R.push(e.jsx(k,{title:"Export Successful",type:"success",children:"User data has been exported successfully"}),{placement:"top-center"})}catch(c){console.error("Export failed:",c),R.push(e.jsx(k,{title:"Export Failed",type:"danger",children:"Failed to export user data. Please try again."}),{placement:"top-center"})}finally{o(!1)}};return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[e.jsx(Ae,{}),e.jsx(Re,{}),e.jsx(C,{className:"md:mb-0 mb-4",size:"sm",icon:e.jsx(ie,{}),loading:t,onClick:u,children:t?"Exporting...":"Export"}),e.jsx(W,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/user-new",children:e.jsx(C,{block:!0,variant:"solid",size:"sm",icon:e.jsx(le,{}),children:"Add Staff"})})]})};X("salesProductList",we);const Et=()=>e.jsxs(ee,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Staffs"}),e.jsx(Oe,{})]}),e.jsx(Ee,{})]});export{Et as default};
