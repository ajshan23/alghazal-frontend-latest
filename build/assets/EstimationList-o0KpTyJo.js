import{r as l,a6 as W,j as e,ae as Q,af as Y,ag as ee,c as $,m as te,ah as b,ai as I,S as B}from"./index-DprkEiEK.js";import{A as se}from"./AdaptableCard-39f9t030.js";import{T as ae,I as re,U as oe,V as ie,W as ne,X as le}from"./index-DRT6ZEuo.js";import{D as ce}from"./DataTable-8O3OokYV.js";import{B as me}from"./Badge-Dt7JCtsY.js";import{I as de}from"./Input-D9aAsaRn.js";import{u as ue,a as ge,b as be,B as z}from"./Button-PtpZLnju.js";import{D as pe}from"./Drawer-CX6y54ar.js";import{F as xe,a as he}from"./formik.esm-PmOj15rT.js";import{F as fe,a as Ce}from"./FormItem-CLbUnAko.js";import{C as j}from"./Skeleton-Ch8Q_reX.js";import{d as je}from"./debounce-b4xpZXdb.js";import"./Card-BpjZUxOM.js";import"./index-CWhs-_CT.js";import"./index-Ds5bsVgF.js";import"./Select-Bn_1dfRU.js";import"./hoist-non-react-statics.cjs-BW0HCES2.js";import"./floating-ui.dom-D1IisfOw.js";import"./Views-BMPEAoNT.js";import"./get-Zx5oz8JG.js";import"./toString-Chg3pnU2.js";import"./index-pu0hqvVK.js";import"./isNil-DH5bwM4B.js";import"./index-x0qbPmga.js";import"./index-Chjiymov.js";import"./CloseButton-DD9EgaVn.js";import"./proxy-LJQ4uuy1.js";import"./cloneDeep-DJN0yfLA.js";import"./index-D-ApMVAy.js";import"./_getPrototype-ZWmpNt_H.js";const ve={Draft:{dotClass:"bg-gray-500"},Sent:{dotClass:"bg-blue-500"},Approved:{dotClass:"bg-emerald-500"},Rejected:{dotClass:"bg-red-500"},Converted:{dotClass:"bg-purple-500"}},ye=({searchTerm:u,filters:m})=>{const i=l.useRef(null),d=W(),[r,v]=l.useState([]),[p,x]=l.useState(!0),[t,c]=l.useState(1),[n,y]=l.useState(10),[k,F]=l.useState(0);l.useEffect(()=>{c(1)},[u,m]),l.useEffect(()=>{(async()=>{var h,f,C,N,w,a;x(!0);try{const g={page:t,limit:n,search:u||void 0};(h=m.status)!=null&&h.length&&(g.status=m.status.join(","));const S=await Q.get(`${Y}/estimation`,{params:g});v(((C=(f=S.data)==null?void 0:f.data)==null?void 0:C.estimations)||[]),F(((a=(w=(N=S.data)==null?void 0:N.data)==null?void 0:w.pagination)==null?void 0:a.total)||0)}catch(g){console.error("Error fetching estimations:",g)}finally{x(!1)}})()},[t,n,u,m]);const D=l.useMemo(()=>[{header:"Estimation No.",accessorKey:"estimationNumber"},{header:"Client Name",accessorKey:"clientName",cell:s=>e.jsx("span",{className:"capitalize",children:s.row.original.clientName})},{header:"Date",accessorKey:"dateOfEstimation",cell:s=>e.jsx("span",{children:new Date(s.row.original.dateOfEstimation).toLocaleDateString()})},{header:"Estimated Amount",accessorKey:"estimatedAmount",cell:s=>e.jsxs("span",{children:["â‚¹",s.row.original.estimatedAmount.toLocaleString()]})},{header:"Status",accessorKey:"status",cell:s=>{var f;const h=s.row.original.status;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:((f=ve[h])==null?void 0:f.dotClass)||"bg-gray-500"}),e.jsx("span",{className:"capitalize font-semibold",children:h})]})}},{header:"Actions",id:"actions",cell:s=>e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:"cursor-pointer p-2 hover:text-blue-500",onClick:()=>d(`/estimations/edit/${s.row.original._id}`),children:e.jsx(ae,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-green-500",onClick:()=>d(`/app/estimation/${s.row.original._id}`),children:e.jsx(re,{})})]})}],[d]),L=s=>c(s),A=s=>{y(s),c(1)};return e.jsx(ce,{ref:i,columns:D,data:r,loading:p,pagingData:{total:k,pageIndex:t,pageSize:n},onPaginationChange:L,onSelectChange:A})},H=l.forwardRef((u,m)=>{var R,T;const{active:i=!1,block:d=!1,children:r,className:v,color:p="",disabled:x=!1,icon:t,loading:c=!1,shape:n="round",size:y,variant:k="default",...F}=u,{themeColor:D,controlSize:L,primaryColorLevel:A}=ee(),s=(R=ue())==null?void 0:R.size,h=(T=ge())==null?void 0:T.size,f="button",C="inline-flex items-center justify-center",N=(p==null?void 0:p.split("-"))||[],w=y||h||s||L,a=N[0]||D,g=N[1]||A,[S,K]=be(g),P=()=>{let o="";switch(w){case I.LG:o=$(`h-${b.lg}`,t&&!r?`w-${b.lg} ${C} text-2xl`:"px-8 py-2 text-base");break;case I.SM:o=$(`h-${b.sm}`,t&&!r?`w-${b.sm} ${C} text-lg`:"px-3 py-2 text-sm");break;case I.XS:o=$(`h-${b.xs}`,t&&!r?`w-${b.xs} ${C} text-base`:"px-3 py-1 text-xs");break;default:o=$(`h-${b.md}`,t&&!r?`w-${b.md} ${C} text-xl`:"px-8 py-2");break}return o},G="opacity-50 cursor-not-allowed",_=()=>{const o={bgColor:i?`bg-${a}-${S}`:`bg-${a}-${g}`,textColor:"text-white",hoverColor:i?"":`hover:bg-${a}-${K}`,activeColor:`active:bg-${a}-${S}`};return E(o)},M=()=>{const o={bgColor:i?`bg-${a}-200 dark:bg-${a}-50`:`bg-${a}-50 dark:bg-${a}-500 dark:bg-opacity-20`,textColor:`text-${a}-${g} dark:text-${a}-50`,hoverColor:i?"":`hover:bg-${a}-100 dark:hover:bg-${a}-500 dark:hover:bg-opacity-30`,activeColor:`active:bg-${a}-200 dark:active:bg-${a}-500 dark:active:bg-opacity-40`};return E(o)},O=()=>E({bgColor:i?"bg-gray-100 border border-gray-300 dark:bg-gray-500 dark:border-gray-500":"bg-white border border-gray-300 dark:bg-gray-700 dark:border-gray-700",textColor:"text-gray-600 dark:text-gray-100",hoverColor:i?"":"hover:bg-gray-50 dark:hover:bg-gray-600",activeColor:"active:bg-gray-100 dark:active:bg-gray-500 dark:active:border-gray-500"}),U=()=>E({bgColor:i?"bg-gray-100 dark:bg-gray-500":"bg-transparent border border-transparent",textColor:"text-gray-600 dark:text-gray-100",hoverColor:i?"":"hover:bg-gray-50 dark:hover:bg-gray-600",activeColor:"active:bg-gray-100 dark:active:bg-gray-500 dark:active:border-gray-500"}),E=({bgColor:o,hoverColor:Z,activeColor:q,textColor:J})=>`${o} ${x||c?G:Z+" "+q} ${J}`,V=$(f,(()=>{switch(k){case"solid":return _();case"twoTone":return M();case"plain":return U();case"default":return O();default:return O()}})(),`radius-${n}`,P(),v,d?"w-full":""),X=()=>c&&r?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(B,{enableTheme:!1,className:"mr-1"}),r]}):t&&!r&&c?e.jsx(B,{enableTheme:!1}):t&&!r&&!c?e.jsx(e.Fragment,{children:t}):t&&r&&!c?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"text-lg",children:t}),e.jsx("span",{className:"ltr:ml-1 rtl:mr-1",children:r})]}):e.jsx(e.Fragment,{children:r});return e.jsx(te,{ref:m,className:V,...F,onClick:o=>{(x||c)&&o.preventDefault()},children:X()})});H.displayName="LinkButton";const ke=({onSearch:u,onFilter:m})=>{const[i,d]=l.useState(!1),r=l.useRef(null),v=je(n=>{u(n)},500),p=n=>{v(n.target.value)},x=()=>d(!0),t=()=>d(!1),c=n=>{m({status:n.status.length>0?n.status:void 0}),t()};return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[e.jsx(de,{ref:r,className:"w-full md:w-96 md:mb-0 mb-4",size:"sm",placeholder:"Search estimations...",prefix:e.jsx(oe,{className:"text-lg"}),onChange:p}),e.jsx(z,{size:"sm",className:"block lg:inline-block md:mb-0 mb-4",icon:e.jsx(ie,{}),onClick:x,children:"Filter"}),e.jsx(z,{block:!0,size:"sm",icon:e.jsx(ne,{}),className:"block lg:inline-block md:mb-0 mb-4",children:"Export"}),e.jsx(H,{to:"/app/create-estimation",block:!0,variant:"solid",size:"sm",icon:e.jsx(le,{}),className:"block lg:inline-block md:mb-0 mb-4",children:"Add Estimation"}),e.jsx(pe,{title:"Filter Estimations",isOpen:i,onClose:t,onRequestClose:t,footer:e.jsxs("div",{className:"text-right w-full",children:[e.jsx(z,{size:"sm",className:"mr-2",onClick:t,children:"Cancel"}),e.jsx(z,{size:"sm",variant:"solid",type:"submit",form:"filter-form",children:"Apply"})]}),children:e.jsx(xe,{initialValues:{status:[]},onSubmit:c,children:({values:n,setFieldValue:y})=>e.jsx(he,{id:"filter-form",children:e.jsx(fe,{children:e.jsxs(Ce,{children:[e.jsx("h6",{className:"mb-4",children:"Estimation Status"}),e.jsxs(j.Group,{vertical:!0,value:n.status,onChange:k=>y("status",k),children:[e.jsx(j,{className:"mb-3",value:"Draft",children:"Draft"}),e.jsx(j,{className:"mb-3",value:"Sent",children:"Sent"}),e.jsx(j,{className:"mb-3",value:"Approved",children:"Approved"}),e.jsx(j,{className:"mb-3",value:"Rejected",children:"Rejected"}),e.jsx(j,{className:"mb-3",value:"Converted",children:"Converted to Job"})]})]})})})})})]})},tt=()=>{const[u,m]=l.useState(""),[i,d]=l.useState({});return e.jsxs(se,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Estimations"}),e.jsx(ke,{onSearch:m,onFilter:d})]}),e.jsx(ye,{searchTerm:u,filters:i})]})};export{tt as default};
