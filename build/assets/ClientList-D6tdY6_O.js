import{a9 as P,aa as S,ab as D,r as n,j as e,v as k,m as g,ae as w}from"./index-D5qsHBPI.js";import{a as T,u as L}from"./SalesService-D6MDyEUo.js";import{A as E}from"./AdaptableCard-UKh7K-Hq.js";import{A as R}from"./index-BVZVTO7z.js";import{D as I}from"./DataTable-B_anoiyl.js";import{I as K,T as $,W as z,X as F}from"./index-Bjc1-Dfl.js";import{a as H}from"./index-ToEsQX21.js";import{u as M}from"./useThemeClass-dAtDPqCv.js";import{d as _}from"./debounce-BcvDMC3O.js";import{I as q}from"./Input-DpzrnPB-.js";import{f as B}from"./api-Bvkxo2jP.js";import{B as h}from"./Button-DKlp8XN1.js";import"./Card-yHUwp5an.js";import"./floating-ui.react-CtRk2jQd.js";import"./floating-ui.dom-D1IisfOw.js";import"./index-CKN0MgBz.js";import"./proxy-QQ9UH2Rr.js";import"./index-WwDzlDyh.js";import"./index-C6AW9Bce.js";import"./Skeleton-Dmiutfuv.js";import"./get-BV5slyYd.js";import"./Views-B1b09e4F.js";import"./toString-kQNaAZON.js";import"./_getPrototype-07QB_bHq.js";import"./Select-DCy0le_o.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-CTX8E6kM.js";import"./index-B0JjbIhn.js";import"./isNil-BKogIPw7.js";const f="salesProductList",x=P(f+"/getProducts",async a=>(await T(a)).data),O={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},G={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:O,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},Q=S({name:`${f}/state`,initialState:G,reducers:{updateProductList:(a,t)=>{a.productList=t.payload},setTableData:(a,t)=>{a.tableData=t.payload},setFilterData:(a,t)=>{a.filterData=t.payload},toggleDeleteConfirmation:(a,t)=>{a.deleteConfirmation=t.payload},setSelectedProduct:(a,t)=>{a.selectedProduct=t.payload}},extraReducers:a=>{a.addCase(x.fulfilled,(t,r)=>{t.productList=r.payload.data,t.tableData.total=r.payload.total,t.loading=!1}).addCase(x.pending,t=>{t.loading=!0})}}),U=Q.reducer,V=D({data:U}),W=({row:a})=>{const{textTheme:t}=M(),r=k(),i=()=>{r(`/app/client-form/${a._id}`)},l=()=>{r(`/app/client-view/${a==null?void 0:a._id}`)};return e.jsxs("div",{className:"flex justify-start text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${t}`,onClick:l,children:e.jsx(K,{})}),e.jsx("span",{className:`cursor-pointer p-2 hover:${t}`,onClick:i,children:e.jsx($,{})})]})},X=({row:a})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{icon:e.jsx(H,{})}),e.jsx("span",{className:"ml-2 rtl:mr-2 font-semibold",children:a.clientName})]}),J=()=>{var p,u;const a=n.useRef(null),[t,r]=n.useState(""),[i,l]=n.useState({page:1,limit:10}),{data:o,isLoading:b,error:m}=L({queryKey:["clients",i.page,i.limit,t],queryFn:()=>B({page:i.page,limit:i.limit,search:t})}),j=((p=o==null?void 0:o.data)==null?void 0:p.clients)||[],d=((u=o==null?void 0:o.data)==null?void 0:u.pagination)||{total:0,page:1,limit:10,totalPages:1,hasNextPage:!1,hasPreviousPage:!1},C=n.useMemo(()=>_(s=>{r(s),l(c=>({...c,page:1}))},500),[]),y=s=>{C(s.target.value)},N=n.useMemo(()=>[{header:"Client Name",accessorKey:"clientName",cell:s=>e.jsx(X,{row:s.row.original})},{header:"Address",accessorKey:"clientAddress",cell:s=>e.jsx("span",{children:s.row.original.clientAddress})},{header:"Mobile",accessorKey:"mobileNumber",cell:s=>e.jsx("span",{children:s.row.original.mobileNumber})},{header:"TRN",accessorKey:"trnNumber",cell:s=>e.jsx("span",{children:s.row.original.trnNumber})},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Action",id:"action",cell:s=>e.jsx(W,{row:s.row.original})}],[]),v=s=>{l(c=>({...c,page:s}))},A=s=>{l(c=>({page:1,limit:s}))};return m?e.jsxs("div",{children:["Error loading clients: ",m.message]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(q,{placeholder:"Search clients...",onChange:y,className:"max-w-md"})}),e.jsx(I,{ref:a,columns:N,data:j,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:b,pagingData:{total:d.total,pageIndex:d.page,pageSize:d.limit},onPaginationChange:v,onSelectChange:A})]})},Y=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(g,{download:!0,className:"block lg:inline-block md:mx-2 md:mb-0 mb-4",to:"/data/client-list.csv",target:"_blank",children:e.jsx(h,{block:!0,size:"sm",icon:e.jsx(z,{}),children:"Export"})}),e.jsx(g,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/client-new",children:e.jsx(h,{block:!0,variant:"solid",size:"sm",icon:e.jsx(F,{}),children:"Add Client"})})]});w("salesClientList",V);const we=()=>e.jsxs(E,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Clients"}),e.jsx(Y,{})]}),e.jsx(J,{})]});export{we as default};
