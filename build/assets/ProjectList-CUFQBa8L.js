import{a9 as A,aa as T,ab as k,ac as I,a as E,j as a,an as R,r as m,v as K,ae as $}from"./index-D5qsHBPI.js";import{a as z,b as q,u as B}from"./SalesService-D6MDyEUo.js";import{A as F}from"./AdaptableCard-UKh7K-Hq.js";import{B as M}from"./Badge-Dxo-y_KI.js";import{D as O}from"./DataTable-B_anoiyl.js";import{I as _,T as H}from"./index-Bjc1-Dfl.js";import{u as G}from"./useThemeClass-dAtDPqCv.js";import{t as Q,N as V}from"./toast-BV-KR3on.js";import{C as W}from"./ConfirmDialog-DxnrbsV4.js";import{d as J}from"./debounce-BcvDMC3O.js";import{I as U}from"./Input-DpzrnPB-.js";import"./Card-yHUwp5an.js";import"./index-WwDzlDyh.js";import"./index-C6AW9Bce.js";import"./Skeleton-Dmiutfuv.js";import"./get-BV5slyYd.js";import"./Views-B1b09e4F.js";import"./toString-kQNaAZON.js";import"./_getPrototype-07QB_bHq.js";import"./Select-DCy0le_o.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-CTX8E6kM.js";import"./floating-ui.dom-D1IisfOw.js";import"./Button-DKlp8XN1.js";import"./index-B0JjbIhn.js";import"./StatusIcon-B-JCnJup.js";import"./CloseButton-CYqIcWKK.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-QQ9UH2Rr.js";import"./index-BVZVTO7z.js";import"./floating-ui.react-CtRk2jQd.js";import"./index-CKN0MgBz.js";import"./Dialog-Dhhpr09S.js";import"./index-BKrnPZdN.js";import"./index-Chjiymov.js";import"./isNil-BKogIPw7.js";const P="salesProductList",g=A(P+"/getProducts",async t=>(await z(t)).data),X=async t=>(await q(t)).data,Y={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Z={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:Y,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},D=T({name:`${P}/state`,initialState:Z,reducers:{updateProductList:(t,e)=>{t.productList=e.payload},setTableData:(t,e)=>{t.tableData=e.payload},setFilterData:(t,e)=>{t.filterData=e.payload},toggleDeleteConfirmation:(t,e)=>{t.deleteConfirmation=e.payload},setSelectedProduct:(t,e)=>{t.selectedProduct=e.payload}},extraReducers:t=>{t.addCase(g.fulfilled,(e,i)=>{e.productList=i.payload.data,e.tableData.total=i.payload.total,e.loading=!1}).addCase(g.pending,e=>{e.loading=!0})}}),{updateProductList:_e,setTableData:He,setFilterData:Ge,toggleDeleteConfirmation:b,setSelectedProduct:Qe}=D.actions,ee=D.reducer,te=k({data:ee}),u=I,ae=()=>{const t=E(),e=u(p=>{var r,n;return(n=(r=p.salesProductList)==null?void 0:r.data)==null?void 0:n.deleteConfirmation}),i=u(p=>{var r,n;return(n=(r=p.salesProductList)==null?void 0:r.data)==null?void 0:n.selectedProduct}),c=u(p=>{var r,n;return(n=(r=p.salesProductList)==null?void 0:r.data)==null?void 0:n.tableData}),l=()=>{t(b(!1))},d=async()=>{t(b(!1)),await X({id:i})&&(t(g(c)),Q.push(a.jsx(V,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Product successfuly deleted"}),{placement:"top-center"}))};return a.jsx(W,{isOpen:e,type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:d,children:a.jsx("p",{children:"Are you sure you want to delete this product? All record related to this product will be deleted as well. This action cannot be undone."})})},se=async t=>{try{const e=await R.get("/project/engineer",{params:t});return console.log(e),e.data}catch(e){throw console.log(e),e}},y={active:{label:"Active",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},inactive:{label:"Inactive",dotClass:"bg-green-500",textClass:"text-green-500"},completed:{label:"Completed",dotClass:"bg-blue-500",textClass:"text-blue-500"}},oe=({row:t})=>{const{textTheme:e}=G(),i=K(),c=()=>{i(`/app/project-edit/${t._id}`)},l=()=>{i(`/app/project-view/${t==null?void 0:t._id}`)};return a.jsxs("div",{className:"flex justify-start text-lg",children:[a.jsx("span",{className:`cursor-pointer p-2 hover:${e}`,onClick:l,children:a.jsx(_,{})}),a.jsx("span",{className:`cursor-pointer p-2 hover:${e}`,onClick:c,children:a.jsx(H,{})})]})},re=()=>{var h,f;const t=m.useRef(null),[e,i]=m.useState(""),[c,l]=m.useState({page:1,limit:10}),{data:d,isLoading:p,error:r,refetch:n}=B({queryKey:["projects",c.page,c.limit,e],queryFn:()=>se({page:c.page,limit:c.limit,search:e}),keepPreviousData:!0}),N=m.useMemo(()=>J(s=>{i(s),l(o=>({...o,page:1}))},500),[]),v=s=>{N(s.target.value)},S=m.useMemo(()=>[{header:"Project Name",accessorKey:"projectName",cell:s=>{var o;return a.jsx("span",{children:(o=s.row.original)==null?void 0:o.projectName})}},{header:"Client Name",accessorKey:"clientName",cell:s=>{var o;return a.jsx("span",{children:(o=s.row.original)==null?void 0:o.client.clientName})}},{header:"Progress",accessorKey:"progress",cell:s=>{var o;return a.jsx("span",{className:"capitalize",children:(o=s.row.original)==null?void 0:o.progress})}},{header:"Project Number",accessorKey:"progress",cell:s=>{var o;return a.jsx("span",{className:"capitalize",children:(o=s.row.original)==null?void 0:o.projectNumber})}},{header:"Status",accessorKey:"status",cell:s=>{var x,C;const o=((x=s.row.original.status)==null?void 0:x.toLowerCase())||"inactive",j=y[o]||y.inactive;return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(M,{className:j.dotClass}),a.jsx("span",{className:`capitalize font-semibold ${j.textClass}`,children:(C=s.row.original)==null?void 0:C.status})]})}},{header:"Action",id:"action",cell:s=>a.jsx(oe,{row:s.row.original})}],[]),w=s=>{l(o=>({...o,page:s}))},L=s=>{l(o=>({page:1,limit:s}))};return r?a.jsxs("div",{children:["Error loading projects: ",r.message]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4",children:a.jsx(U,{placeholder:"Search projects...",onChange:v,className:"max-w-md"})}),a.jsx(O,{ref:t,columns:S,data:((h=d==null?void 0:d.data)==null?void 0:h.projects)||[],skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:p,pagingData:{total:((f=d==null?void 0:d.data)==null?void 0:f.total)||0,pageIndex:c.page,pageSize:c.limit},onPaginationChange:w,onSelectChange:L}),a.jsx(ae,{})]})};$("salesProductList",te);const Ve=()=>a.jsxs(F,{className:"h-full",bodyClass:"h-full",children:[a.jsx("div",{className:"lg:flex items-center justify-between mb-4",children:a.jsx("h3",{className:"mb-4 lg:mb-0",children:"My Works"})}),a.jsx(re,{})]});export{Ve as default};
