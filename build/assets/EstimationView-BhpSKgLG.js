import{ak as C,r as l,u as S,v as T,j as s,a3 as L,b as $}from"./index-D5qsHBPI.js";import{a as M,C as _}from"./Views-B1b09e4F.js";import{C as U}from"./Card-yHUwp5an.js";import{B as u}from"./Button-DKlp8XN1.js";import{L as q}from"./Logo-BFIBE0yI.js";import{_ as c,$ as B}from"./index-Bjc1-Dfl.js";import{u as Y}from"./useThemeClass-dAtDPqCv.js";import{f as H,d as Q}from"./api-BJhJOBXq.js";import"./Alert-C5ubLdhu.js";import"./index-BVZVTO7z.js";import"./Badge-Dxo-y_KI.js";import"./Calendar-DWCnCoFE.js";import"./Skeleton-Dmiutfuv.js";import"./index-BO9RL4R9.js";import"./Dialog-Dhhpr09S.js";import"./Drawer-BUEyqvQR.js";import"./index-DJHxYRo4.js";import"./FormItem-BjAM8sYA.js";import"./useUniqueId-CheqgfIm.js";import"./Input-DpzrnPB-.js";import"./index-QOERWN9e.js";import"./index-CPVaYfOj.js";import{t as f,N as v}from"./toast-BV-KR3on.js";import"./Progress-DzB5YKhk.js";import"./index-CrE-Oq-m.js";import"./ScrollBar-BNGPRGE7.js";import"./index-sVsNsozN.js";import"./Select-DCy0le_o.js";import"./Upload-B1VqOR8x.js";import"./index-WwDzlDyh.js";import"./Tag-DuBUDIYz.js";import"./index-DmRycXSQ.js";import"./StatusIcon-B-JCnJup.js";import"./CloseButton-CYqIcWKK.js";import"./proxy-QQ9UH2Rr.js";import"./floating-ui.react-CtRk2jQd.js";import"./floating-ui.dom-D1IisfOw.js";import"./index-CKN0MgBz.js";import"./useControllableState-OCPLuC6T.js";import"./get-BV5slyYd.js";import"./toString-kQNaAZON.js";import"./_getPrototype-07QB_bHq.js";import"./index-BKrnPZdN.js";import"./index-Chjiymov.js";import"./isNil-BKogIPw7.js";import"./chainedFunction-BxZSneMW.js";import"./index-byIxUKR0.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-CTX8E6kM.js";import"./index-C6AW9Bce.js";const I=()=>{var j,g,y,N,b;const{textTheme:a}=Y(),{id:i}=C(),[P,w]=l.useState(!0),[e,D]=l.useState(null),k=S(t=>t.theme.mode),[o,d]=l.useState(!1),[R,x]=l.useState(""),F=T(),E=()=>{console.log("shaaaa",e),console.log("ajaaaaaa",i),e&&F(`${M}/estimation/edit/${e.project._id}/${i}`,{state:{estimationId:i}})};l.useEffect(()=>{(async()=>{try{if(i){const r=await H(i);D(r.data)}}catch(r){console.error("Error fetching estimation:",r)}finally{w(!1)}})()},[i]);const n=t=>t?$(t).format("DD/MM/YYYY"):"N/A",h=(e==null?void 0:e.materials.reduce((t,r)=>t+r.total,0))||0,m=(e==null?void 0:e.labour.reduce((t,r)=>t+r.total,0))||0,p=(e==null?void 0:e.termsAndConditions.reduce((t,r)=>t+r.total,0))||0,A=async()=>{if(e){d(!0),x("");try{await Q(e._id,e.estimationNumber),f.push(s.jsx(v,{title:"Success",type:"success",children:"PDF downloaded successfully"}))}catch(t){x("Failed to download PDF"),f.push(s.jsx(v,{title:"Error",type:"danger",children:t.message||"Failed to download PDF"}))}finally{d(!1)}}};return s.jsx(L,{loading:P,children:e&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-10",children:[s.jsxs("div",{children:[s.jsx(q,{className:"mb-3",mode:k}),s.jsx("address",{className:"not-italic",children:s.jsxs("div",{children:[s.jsx("h5",{children:(j=e==null?void 0:e.client)==null?void 0:j.clientName}),s.jsx("br",{}),s.jsx("span",{children:(g=e==null?void 0:e.client)==null?void 0:g.clientAddress}),s.jsx("br",{}),s.jsxs("span",{children:["pin : ",(y=e==null?void 0:e.client)==null?void 0:y.pincode]}),s.jsx("br",{}),s.jsx("abbr",{title:"Phone",children:"Phone : "}),s.jsxs("span",{children:[" ",(N=e==null?void 0:e.client)==null?void 0:N.mobileNumber]})]})})]}),s.jsxs("div",{className:"my-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h4",{children:["Estimation #",e==null?void 0:e.estimationNumber]}),s.jsxs("p",{children:["Project: ",(b=e==null?void 0:e.project)==null?void 0:b.projectName]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(c,{className:`text-lg mr-2 ${a}`}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Estimation Date"}),s.jsx("div",{children:n(e==null?void 0:e.createdAt)})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(c,{className:`text-lg mr-2 ${a}`}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Work Start Date"}),s.jsx("div",{children:n(e==null?void 0:e.workStartDate)})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(c,{className:`text-lg mr-2 ${a}`}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Work End Date"}),s.jsx("div",{children:n(e==null?void 0:e.workEndDate)})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(c,{className:`text-lg mr-2 ${a}`}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Valid Until"}),s.jsx("div",{children:n(e==null?void 0:e.validUntil)})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(c,{className:`text-lg mr-2 ${a}`}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Payment Due By"}),s.jsxs("div",{children:[e==null?void 0:e.paymentDueBy," days"]})]})]})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h5",{className:"mb-4",children:"Materials"}),s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:"Description"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"UOM"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Quantity"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Unit Price"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Total"})]})}),s.jsxs("tbody",{children:[e==null?void 0:e.materials.map((t,r)=>s.jsxs("tr",{className:r%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700",children:[s.jsx("td",{className:"px-4 py-3",children:t.description}),s.jsx("td",{className:"px-4 py-3",children:t.uom}),s.jsx("td",{className:"px-4 py-3 text-right",children:t==null?void 0:t.quantity}),s.jsx("td",{className:"px-4 py-3 text-right",children:(t==null?void 0:t.unitPrice)&&t.unitPrice.toFixed(2)}),s.jsx("td",{className:"px-4 py-3 text-right",children:(t==null?void 0:t.total)&&t.total.toFixed(2)})]},t._id)),s.jsxs("tr",{className:"font-semibold bg-gray-100 dark:bg-gray-600",children:[s.jsx("td",{colSpan:4,className:"px-4 py-3 text-right",children:"Total Materials"}),s.jsx("td",{className:"px-4 py-3 text-right",children:h&&h.toFixed(2)})]})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h5",{className:"mb-4",children:"Labour Charges"}),s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:"Designation"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Days"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Price"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Total"})]})}),s.jsxs("tbody",{children:[e==null?void 0:e.labour.map((t,r)=>s.jsxs("tr",{className:r%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700",children:[s.jsx("td",{className:"px-4 py-3",children:t==null?void 0:t.designation}),s.jsx("td",{className:"px-4 py-3 text-right",children:t==null?void 0:t.days}),s.jsx("td",{className:"px-4 py-3 text-right",children:(t==null?void 0:t.price)&&t.price.toFixed(2)}),s.jsx("td",{className:"px-4 py-3 text-right",children:(t==null?void 0:t.total)&&t.total.toFixed(2)})]},t._id)),s.jsxs("tr",{className:"font-semibold bg-gray-100 dark:bg-gray-600",children:[s.jsx("td",{colSpan:3,className:"px-4 py-3 text-right",children:"Total Labour"}),s.jsx("td",{className:"px-4 py-3 text-right",children:m&&m.toFixed(2)})]})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h5",{className:"mb-4",children:"Terms & Conditions (Miscellaneous)"}),s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:"Description"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Qty"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Unit Price"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Total"})]})}),s.jsxs("tbody",{children:[e==null?void 0:e.termsAndConditions.map((t,r)=>s.jsxs("tr",{className:r%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700",children:[s.jsx("td",{className:"px-4 py-3",children:t==null?void 0:t.description}),s.jsx("td",{className:"px-4 py-3 text-right",children:t==null?void 0:t.quantity}),s.jsx("td",{className:"px-4 py-3 text-right",children:(t==null?void 0:t.unitPrice)&&t.unitPrice.toFixed(2)}),s.jsx("td",{className:"px-4 py-3 text-right",children:(t==null?void 0:t.total)&&t.total.toFixed(2)})]},t._id)),s.jsxs("tr",{className:"font-semibold bg-gray-100 dark:bg-gray-600",children:[s.jsx("td",{colSpan:3,className:"px-4 py-3 text-right",children:"Total Miscellaneous"}),s.jsx("td",{className:"px-4 py-3 text-right",children:p&&p.toFixed(2)})]})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h5",{className:"mb-4",children:"Estimation Summary"}),s.jsx("table",{className:"w-full",children:s.jsxs("tbody",{children:[s.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[s.jsx("td",{className:"px-4 py-3 font-semibold",children:"Estimated Amount"}),s.jsx("td",{className:"px-4 py-3 text-right",children:(e==null?void 0:e.estimatedAmount)&&(e==null?void 0:e.estimatedAmount.toFixed(2))})]}),s.jsxs("tr",{className:"bg-white dark:bg-gray-800",children:[s.jsx("td",{className:"px-4 py-3 font-semibold",children:"Quotation Amount"}),s.jsx("td",{className:"px-4 py-3 text-right",children:(e==null?void 0:e.quotationAmount)&&(e==null?void 0:e.quotationAmount.toFixed(2))})]}),s.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-600",children:[s.jsx("td",{className:"px-4 py-3 font-semibold",children:"Commission Amount"}),s.jsx("td",{className:"px-4 py-3 text-right",children:(e==null?void 0:e.commissionAmount)&&(e==null?void 0:e.commissionAmount.toFixed(2))})]}),s.jsxs("tr",{className:"bg-gray-200 dark:bg-gray-500",children:[s.jsx("td",{className:"px-4 py-3 font-semibold",children:"Profit"}),s.jsx("td",{className:"px-4 py-3 text-right",children:(e==null?void 0:e.profit)&&(e==null?void 0:e.profit.toFixed(2))})]})]})})]}),s.jsxs("div",{className:"print:hidden mt-6 flex items-center justify-between",children:[s.jsx("small",{className:"italic",children:"Estimation was created on a computer and is valid without the signature and seal."}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{variant:"solid",loading:o,onClick:A,children:o?"Generating PDF...":"Download PDF"}),s.jsx(u,{variant:"solid",icon:s.jsx(B,{}),onClick:E,children:"Edit"})]})]})]})})},Qs=()=>s.jsx(_,{className:"h-full",children:s.jsx(U,{className:"h-full",bodyClass:"h-full",children:s.jsx(I,{})})});export{Qs as default};
