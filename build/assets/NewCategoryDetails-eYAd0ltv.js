import{r as p,j as e,v as N,ak as F}from"./index-Bb5hWms4.js";import{t as f,N as y}from"./toast-CpYugtuS.js";import{a as S,e as E,b as k}from"./api-BeNeRqD3.js";import{F as B,a as I,b as C}from"./formik.esm-lEj-AbBD.js";import{c as O,a as b}from"./index.esm-D-SZitWC.js";import"./Alert-Dugunmqe.js";import"./index-CUJxdyM4.js";import"./Badge-1rBRPyjl.js";import{B as h}from"./Button-CEPbL0Lb.js";import"./Calendar-D6hwXXzX.js";import"./Card-B8rHCzH9.js";import"./Skeleton-1b1THtL-.js";import"./index-i-B8EDNL.js";import"./Dialog-BD9Iq8Pi.js";import"./Drawer-bwHZPj3y.js";import"./index-xDZoWOTm.js";import{F as A,a as v}from"./FormItem-HvRvrzPo.js";import"./useUniqueId-BnEng_SK.js";import{I as w}from"./Input-Cko6IXRf.js";import"./index-BxyXzxfn.js";import"./index-D9ztJ0Q9.js";import"./Progress-odjwHsxt.js";import"./index-Dk7Y2OWs.js";import"./ScrollBar-BNcJtmRR.js";import"./index-C5YaGYnA.js";import"./Select-D7Yb2KL8.js";import"./Upload-VD0qPFFK.js";import"./index-D9qBG3Fu.js";import"./Tag-e5oFChya.js";import"./index-CDOucsrX.js";import{S as R}from"./StickyFooter-CVbtK3MQ.js";import{A as z}from"./index-BHiXAbZd.js";import{a5 as $}from"./index-DyZvV4US.js";import{C as q}from"./ConfirmDialog-DQueJXox.js";import{A as T}from"./AdaptableCard-CDzqb9V2.js";import"./Views-Dor-7I9u.js";import"./chart.config-YkJl3Uc_.js";import"./DataTable-DFljVjQc.js";import"./SvgIcon-A_UsLZ_J.js";import"./SegmentItemOption-Bzdg9gy2.js";import"./StatusIcon-Bp830_1A.js";import"./CloseButton-EGMOUB2z.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-BmbT6RnM.js";import"./cloneDeep-DJN0yfLA.js";import"./hoist-non-react-statics.cjs-C0OdKYE1.js";import"./floating-ui.react-Ba33Pvev.js";import"./floating-ui.dom-D1IisfOw.js";import"./index-lYREKt9z.js";import"./context-KCROMUm4.js";import"./useControllableState-LB_3bez6.js";import"./_getPrototype-BB6F7yg0.js";import"./index-BKRUeILu.js";import"./index-Chjiymov.js";import"./toString-C-FzytsZ.js";import"./index-D81fdFo4.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./index-DUSL2oPJ.js";import"./index-CxGBFu-E.js";import"./useThemeClass-DlW0H-Tq.js";const D=p.forwardRef((a,r)=>{const{type:s,initialData:m={name:"",description:""},onFormSubmit:n,onDiscard:c,onDelete:l}=a,u=O().shape({name:b().required("Category name is required"),description:b()});return e.jsx(B,{innerRef:r,initialValues:{name:m.name||"",description:m.description||""},validationSchema:u,onSubmit:async(o,{setSubmitting:t,setErrors:g})=>{var x;try{await n(o,t)}catch(d){t(!1),(x=d.message)!=null&&x.includes("Category already exists")&&g({name:"This category name is already registered"})}},enableReinitialize:!0,validateOnChange:!0,validateOnBlur:!0,children:({errors:o,touched:t,isSubmitting:g})=>e.jsx(I,{children:e.jsxs(A,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs(T,{divider:!0,className:"mb-4",children:[e.jsx("h5",{className:"mb-4",children:"Category Information"}),e.jsx(v,{label:"Category Name",invalid:!!(o.name&&t.name),errorMessage:o.name,children:e.jsx(C,{type:"text",autoComplete:"off",name:"name",placeholder:"Enter category name",component:w})}),e.jsx(v,{label:"Description",invalid:!!(o.description&&t.description),errorMessage:o.description,children:e.jsx(C,{as:"textarea",autoComplete:"off",name:"description",placeholder:"Enter any description",component:w,textArea:!0})})]})}),e.jsxs(R,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:s==="edit"&&l&&e.jsx(M,{onDelete:l})}),e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(h,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>c==null?void 0:c(),children:"Discard"}),e.jsx(h,{size:"sm",variant:"solid",loading:g,icon:e.jsx(z,{}),type:"submit",children:"Save"})]})]})]})})})});D.displayName="CategoryDetailsForm";const M=({onDelete:a})=>{const[r,s]=p.useState(!1),m=()=>{s(!1),a==null||a(s)},n=()=>{s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"text-red-600",variant:"plain",size:"sm",icon:e.jsx($,{}),type:"button",onClick:()=>s(!0),children:"Delete"}),e.jsxs(q,{isOpen:r,type:"danger",title:"Delete Category",confirmButtonColor:"red-600",onClose:n,onRequestClose:n,onCancel:n,onConfirm:m,children:[e.jsx("p",{children:"Are you sure you want to delete this category?"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"This action cannot be undone."})]})]})},H={name:"",description:""},Qe=()=>{const a=N(),{id:r}=F(),[s,m]=p.useState(H),[n,c]=p.useState(!!r);p.useEffect(()=>{r&&(async()=>{try{const t=await S(r);if(!t||!t.data)throw new Error("Invalid category data");m({name:t.data.name||"",description:t.data.description||""}),c(!1)}catch(t){console.error("Error fetching category:",t),c(!1),f.push(e.jsx(y,{title:"Failed to fetch category data",type:"danger",duration:2500,children:t.message||"Something went wrong"}),{placement:"top-center"}),a("/app/categories")}})()},[r,a]);const l=async(o,t)=>{var d,j;t(!0);try{let i;r?i=await E(r,o):i=await k(o),i.status,t(!1),f.push(e.jsxs(y,{title:`Successfully ${r?"updated":"added"} category`,type:"success",duration:2500,children:["Category ",r?"updated":"added"," successfully"]}),{placement:"top-center"}),a("/app/cat-view")}catch(i){console.error("Error during form submission:",i),t(!1),f.push(e.jsx(y,{title:`Error ${r?"updating":"adding"} category`,type:"danger",duration:2500,children:((j=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:j.message)||i.message}),{placement:"top-center"})}},u=()=>{a("/app/categories")};return n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsx(D,{type:r?"edit":"new",initialData:s,onFormSubmit:l,onDiscard:u})};export{Qe as default};
