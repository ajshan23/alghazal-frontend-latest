import{a9 as P,aa as S,ab as D,r as n,j as e,v as k,m as g,ae as w}from"./index-3DLZI4eB.js";import{a as L}from"./SalesService-L0xmFpXs.js";import{A as T}from"./AdaptableCard-DUhwjOtA.js";import{A as E}from"./index-DPb5rspz.js";import{D as R}from"./DataTable-CU1UK92B.js";import{O as K,a0 as F,a3 as I,a4 as $}from"./index-CwjAikcA.js";import{F as z}from"./index-B-0wTPkb.js";import{u as H}from"./useThemeClass-B_GK6Zwz.js";import{u as M}from"./useQuery-Dx8uzGh7.js";import{d as _}from"./debounce-CRGwQgqv.js";import{I as q}from"./Input-BCKKbbYo.js";import{f as O}from"./api-DjXueUlm.js";import{B as h}from"./Button-C9ww9UOL.js";import"./Card-CF9KcGlH.js";import"./floating-ui.react-BR9Qsiv-.js";import"./floating-ui.dom-D1IisfOw.js";import"./index-ejasuVWi.js";import"./proxy-h8u1Q_39.js";import"./index-B2vv1dQX.js";import"./index-VcVS_xjk.js";import"./Skeleton-DYaberbX.js";import"./Views-CKmk2VLX.js";import"./_getPrototype-BB9zh0H4.js";import"./Select-DbBYdRQK.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-DT5H6Lbl.js";import"./context-DV85rUc2.js";import"./index-CgdDCE4T.js";import"./toString-Cp3uycBW.js";const f="salesProductList",x=P(f+"/getProducts",async a=>(await L(a)).data),B={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},G={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:B,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},Q=S({name:`${f}/state`,initialState:G,reducers:{updateProductList:(a,t)=>{a.productList=t.payload},setTableData:(a,t)=>{a.tableData=t.payload},setFilterData:(a,t)=>{a.filterData=t.payload},toggleDeleteConfirmation:(a,t)=>{a.deleteConfirmation=t.payload},setSelectedProduct:(a,t)=>{a.selectedProduct=t.payload}},extraReducers:a=>{a.addCase(x.fulfilled,(t,r)=>{t.productList=r.payload.data,t.tableData.total=r.payload.total,t.loading=!1}).addCase(x.pending,t=>{t.loading=!0})}}),U=Q.reducer,V=D({data:U}),J=({row:a})=>{const{textTheme:t}=H(),r=k(),i=()=>{r(`/app/client-form/${a._id}`)},l=()=>{r(`/app/client-view/${a==null?void 0:a._id}`)};return e.jsxs("div",{className:"flex justify-start text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${t}`,onClick:l,children:e.jsx(K,{})}),e.jsx("span",{className:`cursor-pointer p-2 hover:${t}`,onClick:i,children:e.jsx(F,{})})]})},W=({row:a})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{icon:e.jsx(z,{})}),e.jsx("span",{className:"ml-2 rtl:mr-2 font-semibold",children:a.clientName})]}),X=()=>{var p,u;const a=n.useRef(null),[t,r]=n.useState(""),[i,l]=n.useState({page:1,limit:10}),{data:o,isLoading:b,error:m}=M({queryKey:["clients",i.page,i.limit,t],queryFn:()=>O({page:i.page,limit:i.limit,search:t})}),j=((p=o==null?void 0:o.data)==null?void 0:p.clients)||[],d=((u=o==null?void 0:o.data)==null?void 0:u.pagination)||{total:0,page:1,limit:10,totalPages:1,hasNextPage:!1,hasPreviousPage:!1},C=n.useMemo(()=>_(s=>{r(s),l(c=>({...c,page:1}))},500),[]),y=s=>{C(s.target.value)},N=n.useMemo(()=>[{header:"Client Name",accessorKey:"clientName",cell:s=>e.jsx(W,{row:s.row.original})},{header:"Address",accessorKey:"clientAddress",cell:s=>e.jsx("span",{children:s.row.original.clientAddress})},{header:"Mobile",accessorKey:"mobileNumber",cell:s=>e.jsx("span",{children:s.row.original.mobileNumber})},{header:"TRN",accessorKey:"trnNumber",cell:s=>e.jsx("span",{children:s.row.original.trnNumber})},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Action",id:"action",cell:s=>e.jsx(J,{row:s.row.original})}],[]),v=s=>{l(c=>({...c,page:s}))},A=s=>{l(c=>({page:1,limit:s}))};return m?e.jsxs("div",{children:["Error loading clients: ",m.message]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(q,{placeholder:"Search clients...",onChange:y,className:"max-w-md"})}),e.jsx(R,{ref:a,columns:N,data:j,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:b,pagingData:{total:d.total,pageIndex:d.page,pageSize:d.limit},onPaginationChange:v,onSelectChange:A})]})},Y=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(g,{download:!0,className:"block lg:inline-block md:mx-2 md:mb-0 mb-4",to:"/data/client-list.csv",target:"_blank",children:e.jsx(h,{block:!0,size:"sm",icon:e.jsx(I,{}),children:"Export"})}),e.jsx(g,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/client-new",children:e.jsx(h,{block:!0,variant:"solid",size:"sm",icon:e.jsx($,{}),children:"Add Client"})})]});w("salesClientList",V);const we=()=>e.jsxs(T,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Clients"}),e.jsx(Y,{})]}),e.jsx(X,{})]});export{we as default};
